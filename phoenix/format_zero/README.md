# Exploit Education - Phoenix - Format Zero
url: http://exploit.education/phoenix/format-zero/

difficulty: Low

type: format_string

info: https://owasp.org/www-community/attacks/Format_string_attack

# Tools
* Linux
* gef (https://gef.readthedocs.io/en/master/)
* gdb (`apt install gdb`)

# Content
* `format_zero` - binary (format_zero: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 3.2.0, not stripped)
* `format_zero.c` - original file with added **LEVELNAME** define

# Analysis
Like what the title of this challenge says, it's probably a format string vulnerability and coming from previous
challenges, you might think that this will be similiar. At this point you should be familiar with what the format 
string attack is from the __info__ url on owasp website.

## The code
```
 21   struct {¬
 22     char dest[32];¬
 23     volatile int changeme;¬
 24   } locals;¬
 25   char buffer[16];¬
 26 ¬
 27   printf("%s\n", BANNER);¬
 28 ¬
 29   **if (fgets(buffer, sizeof(buffer) - 1, stdin) == NULL) {**¬
 30     errx(1, "Unable to get buffer");¬
 31   }¬
 32   buffer[15] = 0;¬
 33 ¬
 34   locals.changeme = 0;¬
 35 ¬
 36   sprintf(locals.dest, buffer);¬
 37 ¬
 38   if (locals.changeme != 0) {¬
```